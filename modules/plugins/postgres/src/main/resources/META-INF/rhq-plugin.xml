<?xml version="1.0" encoding="UTF-8" ?>

<plugin name="Postgres"
        displayName="PostgreSQL Database"
        package="org.rhq.plugins.postgres"
        pluginLifecycleListener="PostgresPluginLifecycleListener"
        description="Management and monitoring of PostgreSQL versions 8.2 and higher"
        xmlns="urn:xmlns:rhq-plugin"
        xmlns:c="urn:xmlns:rhq-configuration">

   <depends plugin="Database" useClasses="true"/>

   <server name="Postgres Server" discovery="PostgresDiscoveryComponent" class="PostgresServerComponent"
           description="PostgreSQL Server"
           supportsManualAdd="true">

      <version match="8.0"/>

      <!-- Properties are connection/lookup configurations. They are values that the
         plugin components need to connect and interact with the resource. -->
      <plugin-configuration>
         <!-- Defaults:
               type: string
               required: true
               activationPolicy: immediate
         -->
         <c:simple-property name="host" default="127.0.0.1" displayName="listen host" description="the hostname or IP address that the database is listening on"/>
         <c:simple-property name="port" default="5432" displayName="listen port" description="the TCP port that the database is listening on">
            <c:constraint>
               <c:integer-constraint minimum="1" maximum="65535"/>
            </c:constraint>
         </c:simple-property>
         <c:simple-property name="db" default="postgres" displayName="database name" description="the name of the database to connect to"/>

         <c:simple-property name="driverClass" default="org.postgresql.Driver" displayName="JDBC driver class"
                          description="the fully-qualified classname of the JDBC driver class" required="false"/>
         <c:simple-property name="principal" default="postgres" displayName="role name" description="the database role to connect as"/>
         <c:simple-property name="credentials" default="postgres" type="password" displayName="role password"
                          description="the password for the database role being used to connect"/>
         <c:simple-property name="pgdataDir" type="directory" displayName="PGDATA directory"
                          description="the absolute path to the directory containing the cluster configuration files postgresql.conf, pg_hba.conf, and pg_ident.conf"/>
         <c:simple-property name="configFile" type="file" displayName="configuration file"
                          description="the absolute path to the main cluster configuration file; default value is '{pgDataDir}/postgresql.conf', where [pgDataDir] is the value of the pgDataDir connection property" required="false"/>
      </plugin-configuration>

      <process-scan name="windows" query="process|basename|match=^(?i)(postgres|postmaster)\.exe$,process|basename|nomatch|parent=^(?i)(postgres|postmaster)\.exe$" />
      <process-scan name="unix" query="process|basename|match=^(postgres|postmaster)$,process|basename|nomatch|parent=^(postgres|postmaster)$" />

      <operation name="listProcessStatistics" description="List statistics about the currently executing postgres backends. &lt;em&gt;state&lt;/em&gt; column result is only available with Postgres 9.2+">
         <results>
            <c:list-property name="processList">
               <c:map-property name="process">
                  <c:simple-property name="pid" type="integer"/>
                  <c:simple-property name="userName"/>
                  <c:simple-property name="query"/>
                  <c:simple-property name="state"/>
                  <c:simple-property name="address"/>
                  <c:simple-property name="port"/>
               </c:map-property>
            </c:list-property>
         </results>
      </operation>

      <metric displayName="User Time" property="Process.aggregateCpu.user" measurementType="trendsup" units="milliseconds" displayType="summary"
              description="The aggregate amount of CPU user time spent by all postgres processes"/>
      <metric displayName="Kernel Time" property="Process.aggregateCpu.sys" measurementType="trendsup" units="milliseconds" displayType="summary"
              description="The aggregate amount of CPU kernel time spent by all postgres processes"/>
      <metric displayName="CPU Percentage" property="Process.aggregateCpu.percent" measurementType="dynamic" units="percentage" displayType="summary"
              description="The percentage of CPU currently being used by all postgres processes"/>
      <metric displayName="Physical Memory" property="Process.aggregateMemory.resident" measurementType="dynamic" units="bytes" displayType="summary"
              description="The aggregate amount of resident memory used by all postgres processes"/>
      <metric displayName="Virtual Memory" property="Process.aggregateMemory.size" measurementType="dynamic" units="bytes" displayType="summary"
              description="The aggregate amount of virtual memory used by all postgres processes"/>
      <metric displayName="Open File Descriptors" property="Process.aggregateFileDescriptor.total" measurementType="dynamic" displayType="summary"
              description="The aggregate number of file descriptors open by all postgres processes"/>
      <metric displayName="Active Backends" property="Database.backends" measurementType="dynamic" displayType="summary"
              description="Number of currently active backends (user connections)"/>
      <metric displayName="Start time" property="Database.startTime" dataType="trait" displayType="summary"
              description="Start time of the PostgreSQL database server"/>

      <!-- Metrics coming from runtime properties -->
      
      <metric property="Runtime.add_missing_from" displayName="Add Missing From" dataType="trait"
              description="Automatically adds missing table references to FROM clauses"/>
      <metric property="Runtime.allow_system_table_mods" displayName="Allow System Table Mods" dataType="trait"
              description="Allows modifications of the structure of system tables"/>
      <metric property="Runtime.archive_command" displayName="Archive Command" dataType="trait"
              description="WAL archiving command"/>
      <metric property="Runtime.archive_timeout" displayName="Archive Timeout" dataType="trait"
              description="Forces a switch to the next xlog file if a new file has not been started within the specified amount of time"/>
      <metric property="Runtime.array_nulls" displayName="Array Nulls" dataType="trait"
              description="Enable input of NULL elements in arrays."/>
      <metric property="Runtime.authentication_timeout" displayName="Authentication Timeout" dataType="trait"
              description="The maximum allowed time to complete client authentication"/>
      <metric property="Runtime.autovacuum" displayName="Autovacuum" dataType="trait"
              description="Starts the autovacuum subprocess."/>
      <metric property="Runtime.autovacuum_analyze_scale_factor" displayName="Autovacuum Analyze Scale Factor" dataType="trait"
              description="Number of tuple inserts, updates or deletes prior to analyze as a fraction of reltuples."/>
      <metric property="Runtime.autovacuum_analyze_threshold" displayName="Autovacuum Analyze Threshold" dataType="trait"
              description="Minimum number of tuple inserts, updates or deletes prior to analyze."/>
      <metric property="Runtime.autovacuum_freeze_max_age" displayName="Autovacuum Freeze Max Age" dataType="trait"
              description="Age (in transactions) at which to autovacuum a table to prevent transaction ID wraparound."/>
      <metric property="Runtime.autovacuum_naptime" displayName="Autovacuum Naptime" dataType="trait"
              description="Amount of time to sleep between autovacuum runs"/>
      <metric property="Runtime.autovacuum_vacuum_cost_delay" displayName="Autovacuum Vacuum Cost Delay" dataType="trait"
              description="Vacuum cost delay for autovacuum"/>
      <metric property="Runtime.autovacuum_vacuum_cost_limit" displayName="Autovacuum Vacuum Cost Limit" dataType="trait"
              description="Vacuum cost amount available before napping, for autovacuum."/>
      <metric property="Runtime.autovacuum_vacuum_scale_factor" displayName="Autovacuum Vacuum Scale Factor" dataType="trait"
              description="Number of tuple updates or deletes prior to vacuum as a fraction of reltuples."/>
      <metric property="Runtime.autovacuum_vacuum_threshold" displayName="Autovacuum Vacuum Threshold" dataType="trait"
              description="Minimum number of tuple updates or deletes prior to vacuum."/>
      <metric property="Runtime.backslash_quote" displayName="Backslash Quote" dataType="trait"
              description="Whether quotes are allowed in string literals"/>
      <metric property="Runtime.bgwriter_all_maxpages" displayName="Bgwriter All Maxpages" dataType="trait"
              description="Background writer maximum number of all pages to flush per round"/>
      <metric property="Runtime.bgwriter_all_percent" displayName="Bgwriter All Percent" dataType="trait"
              description="Background writer percentage of all buffers to flush per round"/>
      <metric property="Runtime.bgwriter_delay" displayName="Bgwriter Delay" dataType="trait"
              description="Background writer sleep time between rounds; default unit is milliseconds"/>
      <metric property="Runtime.bgwriter_lru_maxpages" displayName="Bgwriter Lru Maxpages" dataType="trait"
              description="Background writer maximum number of LRU pages to flush per round"/>
      <metric property="Runtime.bgwriter_lru_percent" displayName="Bgwriter Lru Percent" dataType="trait"
              description="Background writer percentage of LRU buffers to flush per round"/>
      <metric property="Runtime.block_size" displayName="Block Size" dataType="trait"
              description="Shows size of a disk block; determined by the value of BLCKSZ when building the server; default unit is bytes"/>
      <metric property="Runtime.bonjour_name" displayName="Bonjour Name" dataType="trait"
              description="The Bonjour broadcast service name"/>
      <metric property="Runtime.check_function_bodies" displayName="Check Function Bodies" dataType="trait"
              description="Check function bodies during CREATE FUNCTION."/>
      <metric property="Runtime.checkpoint_segments" displayName="Checkpoint Segments" dataType="trait"
              description="The maximum distance (in log segments) between automatic WAL checkpoints."/>
      <metric property="Runtime.checkpoint_timeout" displayName="Checkpoint Timeout" dataType="trait"
              description="The maximum amount of time between automatic WAL checkpoints; default unit is seconds"/>
      <metric property="Runtime.checkpoint_warning" displayName="Checkpoint Warning" dataType="trait"
              description="Logs if filling of checkpoint segments happens more frequently than this amount of time; default unit is seconds"/>
      <metric property="Runtime.client_encoding" displayName="Client Encoding" dataType="trait"
              description="The client's character set encoding."/>
      <metric property="Runtime.client_min_messages" displayName="Client Min Messages" dataType="trait"
              description="The message levels that are sent to the client."/>
      <metric property="Runtime.commit_delay" displayName="Commit Delay" dataType="trait"
              description="The delay in between transaction commit and flushing WAL to disk; default unit is microseconds"/>
      <metric property="Runtime.commit_siblings" displayName="Commit Siblings" dataType="trait"
              description="The minimum concurrent open transactions before performing commit_delay."/>
      <metric property="Runtime.config_file" displayName="Config File" dataType="trait"
              description="The server's main configuration file."/>
      <metric property="Runtime.constraint_exclusion" displayName="Constraint Exclusion" dataType="trait"
              description="Enables the planner to use constraints to optimize queries."/>
      <metric property="Runtime.cpu_index_tuple_cost" displayName="Cpu Index Tuple Cost" dataType="trait"
              description="The planner's estimate of the cost of processing each index entry during an index scan; measured on the same scale as the seq_page_cost configuration parameter"/>
      <metric property="Runtime.cpu_operator_cost" displayName="Cpu Operator Cost" dataType="trait"
              description="The planner's estimate of the cost of processing each operator or function call; measured on the same scale as the seq_page_cost configuration parameter"/>
      <metric property="Runtime.cpu_tuple_cost" displayName="Cpu Tuple Cost" dataType="trait"
              description="The planner's estimate of the cost of processing each tuple (row); measured on the same scale as the seq_page_cost configuration parameter"/>
      <metric property="Runtime.custom_variable_classes" displayName="Custom Variable Classes" dataType="trait"
              description="The list of known custom variable classes"/>
      <metric property="Runtime.data_directory" displayName="Data Directory" dataType="trait"
              description="The server's data directory."/>
      <metric property="Runtime.DateStyle" displayName="DateStyle" dataType="trait"
              description="The display format for date and time values."/>
      <metric property="Runtime.db_user_namespace" displayName="Db User Namespace" dataType="trait"
              description="Enables per-database user names."/>
      <metric property="Runtime.deadlock_timeout" displayName="Deadlock Timeout" dataType="trait"
              description="The amount of time to wait on lock before checking for a deadlock; default unit is milliseconds"/>
      <metric property="Runtime.debug_assertions" displayName="Debug Assertions" dataType="trait"
              description="Turns on various assertion checks."/>
      <metric property="Runtime.debug_pretty_print" displayName="Debug Pretty Print" dataType="trait"
              description="Indents parse and plan tree displays."/>
      <metric property="Runtime.debug_print_parse" displayName="Debug Print Parse" dataType="trait"
              description="Prints the parse tree to the server log."/>
      <metric property="Runtime.debug_print_plan" displayName="Debug Print Plan" dataType="trait"
              description="Prints the execution plan to server log."/>
      <metric property="Runtime.debug_print_rewritten" displayName="Debug Print Rewritten" dataType="trait"
              description="Prints the parse tree after rewriting to server log."/>
      <metric property="Runtime.default_statistics_target" displayName="Default Statistics Target" dataType="trait"
              description="The default statistics target; range 1-1000."/>
      <metric property="Runtime.default_tablespace" displayName="Default Tablespace" dataType="trait"
              description="The default tablespace to create tables and indexes in."/>
      <metric property="Runtime.default_transaction_isolation" displayName="Default Transaction Isolation" dataType="trait"
              description="The transaction isolation level of each new transaction."/>
      <metric property="Runtime.default_transaction_read_only" displayName="Default Transaction Read Only" dataType="trait"
              description="The default read-only status of new transactions."/>
      <metric property="Runtime.default_with_oids" displayName="Default With Oids" dataType="trait"
              description="Create new tables with OIDs by default."/>
      <metric property="Runtime.dynamic_library_path" displayName="Dynamic Library Path" dataType="trait"
              description="The path for dynamically loadable modules."/>
      <metric property="Runtime.effective_cache_size" displayName="Effective Cache Size" dataType="trait"
              description="The planner's assumption about size of the disk cache; the unit is disk pages, which are normally 8KB each"/>
      <metric property="Runtime.enable_bitmapscan" displayName="Enable Bitmapscan" dataType="trait"
              description="Enables the planner's use of bitmap-scan plans."/>
      <metric property="Runtime.enable_hashagg" displayName="Enable Hashagg" dataType="trait"
              description="Enables the planner's use of hashed aggregation plans."/>
      <metric property="Runtime.enable_hashjoin" displayName="Enable Hashjoin" dataType="trait"
              description="Enables the planner's use of hash join plans."/>
      <metric property="Runtime.enable_indexscan" displayName="Enable Indexscan" dataType="trait"
              description="Enables the planner's use of index-scan plans."/>
      <metric property="Runtime.enable_mergejoin" displayName="Enable Mergejoin" dataType="trait"
              description="Enables the planner's use of merge join plans."/>
      <metric property="Runtime.enable_nestloop" displayName="Enable Nestloop" dataType="trait"
              description="Enables the planner's use of nested-loop join plans."/>
      <metric property="Runtime.enable_seqscan" displayName="Enable Seqscan" dataType="trait"
              description="Enables the planner's use of sequential-scan plans."/>
      <metric property="Runtime.enable_sort" displayName="Enable Sort" dataType="trait"
              description="Enables the planner's use of explicit sort steps."/>
      <metric property="Runtime.enable_tidscan" displayName="Enable Tidscan" dataType="trait"
              description="Enables the planner's use of TID scan plans."/>
      <metric property="Runtime.escape_string_warning" displayName="Escape String Warning" dataType="trait"
              description="Warn about backslash escapes in ordinary string literals."/>
      <metric property="Runtime.explain_pretty_print" displayName="Explain Pretty Print" dataType="trait"
              description="Uses the indented output format for EXPLAIN VERBOSE."/>
      <metric property="Runtime.external_pid_file" displayName="External Pid File" dataType="trait"
              description="Writes the postmaster PID to the specified file."/>
      <metric property="Runtime.extra_float_digits" displayName="Extra Float Digits" dataType="trait"
              description="The number of extra digits displayed for floating-point values."/>
      <metric property="Runtime.from_collapse_limit" displayName="From Collapse Limit" dataType="trait"
              description="The FROM-list size beyond which subqueries are not collapsed"/>
      <metric property="Runtime.fsync" displayName="Fsync" dataType="trait"
              description="Forces synchronization of updates to disk."/>
      <metric property="Runtime.full_page_writes" displayName="Full Page Writes" dataType="trait"
              description="Writes full pages to WAL when first modified after a checkpoint."/>
      <metric property="Runtime.geqo" displayName="Geqo" dataType="trait"
              description="Enables genetic query optimization"/>
      <metric property="Runtime.geqo_effort" displayName="Geqo Effort" dataType="trait"
              description="GEQO: effort is used to set the default for other GEQO parameters; range 1-10"/>
      <metric property="Runtime.geqo_generations" displayName="Geqo Generations" dataType="trait"
              description="GEQO: number of iterations of the algorithm; default selected based on effort."/>
      <metric property="Runtime.geqo_pool_size" displayName="Geqo Pool Size" dataType="trait"
              description="GEQO: number of individuals in the population; default selected based on effort."/>
      <metric property="Runtime.geqo_selection_bias" displayName="Geqo Selection Bias" dataType="trait"
              description="GEQO: selective pressure within the population."/>
      <metric property="Runtime.geqo_threshold" displayName="Geqo Threshold" dataType="trait"
              description="The threshold of FROM items beyond which GEQO is used."/>
      <metric property="Runtime.gin_fuzzy_search_limit" displayName="Gin Fuzzy Search Limit" dataType="trait"
              description="The maximum allowed result for exact search by GIN."/>
      <metric property="Runtime.hba_file" displayName="Hba File" dataType="trait"
              description="The server's hba [configuration file]"/>
      <metric property="Runtime.ident_file" displayName="Ident File" dataType="trait"
              description="The server's ident [configuration file]"/>
      <metric property="Runtime.ignore_system_indexes" displayName="Ignore System Indexes" dataType="trait"
              description="Disables reading from system indexes."/>
      <metric property="Runtime.integer_datetimes" displayName="Integer Datetimes" dataType="trait"
              description="Datetimes are integer based."/>
      <metric property="Runtime.join_collapse_limit" displayName="Join Collapse Limit" dataType="trait"
              description="The FROM-list size beyond which JOIN constructs are not flattened"/>
      <metric property="Runtime.krb_caseins_users" displayName="Krb Caseins Users" dataType="trait"
              description="Whether Kerberos user names should be treated as case-insensitive."/>
      <metric property="Runtime.krb_server_hostname" displayName="Krb Server Hostname" dataType="trait"
              description="The hostname of the Kerberos server."/>
      <metric property="Runtime.krb_server_keyfile" displayName="Krb Server Keyfile" dataType="trait"
              description="The location of the Kerberos server key file."/>
      <metric property="Runtime.krb_srvname" displayName="Krb Srvname" dataType="trait"
              description="The name of the Kerberos service."/>
      <metric property="Runtime.lc_collate" displayName="Lc Collate" dataType="trait"
              description="Shows the collation order locale."/>
      <metric property="Runtime.lc_ctype" displayName="Lc Ctype" dataType="trait"
              description="Shows the character classification and case conversion locale."/>
      <metric property="Runtime.lc_messages" displayName="Lc Messages" dataType="trait"
              description="The language in which messages are displayed."/>
      <metric property="Runtime.lc_monetary" displayName="Lc Monetary" dataType="trait"
              description="The locale for formatting monetary amounts."/>
      <metric property="Runtime.lc_numeric" displayName="Lc Numeric" dataType="trait"
              description="The locale for formatting numbers."/>
      <metric property="Runtime.lc_time" displayName="Lc Time" dataType="trait"
              description="The locale for formatting date and time values."/>
      <metric property="Runtime.listen_addresses" displayName="Listen Addresses" dataType="trait"
              description="The host name or IP address(es) to listen to."/>
      <metric property="Runtime.local_preload_libraries" displayName="Local Preload Libraries" dataType="trait"
              description="Lists shared libraries to preload into each backend."/>
      <metric property="Runtime.log_connections" displayName="Log Connections" dataType="trait"
              description="Logs each successful connection."/>
      <metric property="Runtime.log_destination" displayName="Log Destination" dataType="trait"
              description="The destination for server log output."/>
      <metric property="Runtime.log_directory" displayName="Log Directory" dataType="trait"
              description="The destination directory for log files."/>
      <metric property="Runtime.log_disconnections" displayName="Log Disconnections" dataType="trait"
              description="Logs end of a session, including duration."/>
      <metric property="Runtime.log_duration" displayName="Log Duration" dataType="trait"
              description="Logs the duration of each completed SQL statement."/>
      <metric property="Runtime.log_error_verbosity" displayName="Log Error Verbosity" dataType="trait"
              description="The verbosity of logged messages."/>
      <metric property="Runtime.log_executor_stats" displayName="Log Executor Stats" dataType="trait"
              description="Writes executor performance statistics to the server log."/>
      <metric property="Runtime.log_filename" displayName="Log Filename" dataType="trait"
              description="The file name pattern for log files."/>
      <metric property="Runtime.log_hostname" displayName="Log Hostname" dataType="trait"
              description="Logs the host name in the connection logs."/>
      <metric property="Runtime.log_line_prefix" displayName="Log Line Prefix" dataType="trait"
              description="Controls information prefixed to each log line"/>
      <metric property="Runtime.log_min_duration_statement" displayName="Log Min Duration Statement" dataType="trait"
              description="The minimum execution time (in milliseconds) above which statements will be logged."/>
      <metric property="Runtime.log_min_error_statement" displayName="Log Min Error Statement" dataType="trait"
              description="Causes all statements generating error at or above this level to be logged."/>
      <metric property="Runtime.log_min_messages" displayName="Log Min Messages" dataType="trait"
              description="The message levels that are logged."/>
      <metric property="Runtime.log_parser_stats" displayName="Log Parser Stats" dataType="trait"
              description="Writes parser performance statistics to the server log."/>
      <metric property="Runtime.log_planner_stats" displayName="Log Planner Stats" dataType="trait"
              description="Writes planner performance statistics to the server log."/>
      <metric property="Runtime.log_rotation_age" displayName="Log Rotation Age" dataType="trait"
              description="Automatic log file rotation will occur after this amount of time; default unit is minutes"/>
      <metric property="Runtime.log_rotation_size" displayName="Log Rotation Size" dataType="trait"
              description="Automatic log file rotation will occur when the file reaches this size; default unit is kilobytes"/>
      <metric property="Runtime.log_statement" displayName="Log Statement" dataType="trait"
              description="The type of statements logged."/>
      <metric property="Runtime.log_statement_stats" displayName="Log Statement Stats" dataType="trait"
              description="Writes cumulative performance statistics to the server log."/>
      <metric property="Runtime.log_truncate_on_rotation" displayName="Log Truncate On Rotation" dataType="trait"
              description="Truncate existing log files of same name during log rotation."/>
      <metric property="Runtime.maintenance_work_mem" displayName="Maintenance Work Mem" dataType="trait"
              description="The maximum memory to be used for maintenance operations."/>
      <metric property="Runtime.max_connections" displayName="Max Connections" dataType="trait"
              description="The maximum number of concurrent connections."/>
      <metric property="Runtime.max_files_per_process" displayName="Max Files Per Process" dataType="trait"
              description="The maximum number of simultaneously open files for each server process."/>
      <metric property="Runtime.max_fsm_pages" displayName="Max Fsm Pages" dataType="trait"
              description="The maximum number of disk pages for which free space is tracked."/>
      <metric property="Runtime.max_fsm_relations" displayName="Max Fsm Relations" dataType="trait"
              description="The maximum number of tables and indexes for which free space is tracked."/>
      <metric property="Runtime.max_function_args" displayName="Max Function Args" dataType="trait"
              description="Shows the maximum number of function arguments."/>
      <metric property="Runtime.max_identifier_length" displayName="Max Identifier Length" dataType="trait"
              description="Shows the maximum identifier length"/>
      <metric property="Runtime.max_index_keys" displayName="Max Index Keys" dataType="trait"
              description="Shows the maximum number of index keys."/>
      <metric property="Runtime.max_locks_per_transaction" displayName="Max Locks Per Transaction" dataType="trait"
              description="The maximum number of locks per transaction."/>
      <metric property="Runtime.max_prepared_transactions" displayName="Max Prepared Transactions" dataType="trait"
              description="The maximum number of simultaneously prepared transactions."/>
      <metric property="Runtime.max_stack_depth" displayName="Max Stack Depth" dataType="trait"
              description="The maximum size of the server's execution stack; default unit is kilobytes"/>
      <metric property="Runtime.password_encryption" displayName="Password Encryption" dataType="trait"
              description="Encrypt passwords."/>
      <metric property="Runtime.port" displayName="Port" dataType="trait"
              description="The TCP port the server listens on"/>
      <metric property="Runtime.post_auth_delay" displayName="Post Auth Delay" dataType="trait"
              description="Waits the specified amount of time on connection startup after authentication; default unit is seconds"/>
      <metric property="Runtime.pre_auth_delay" displayName="Pre Auth Delay" dataType="trait"
              description="Waits the specified amount of time on connection startup before authentication; default unit is seconds"/>
      <metric property="Runtime.random_page_cost" displayName="Random Page Cost" dataType="trait"
              description="The planner's estimate of the cost of a nonsequentially fetched disk page; measured on the same scale as the seq_page_cost configuration parameter"/>
      <metric property="Runtime.redirect_stderr" displayName="Redirect Stderr" dataType="trait"
              description="Start a subprocess to capture stderr output into log files"/>
      <metric property="Runtime.regex_flavor" displayName="Regex Flavor" dataType="trait"
              description="The regular expression flavor."/>
      <metric property="Runtime.search_path" displayName="Search Path" dataType="trait"
              description="The schema search order for names that are not schema-qualified."/>
      <metric property="Runtime.seq_page_cost" displayName="Seq Page Cost" dataType="trait"
              description="The planner's estimate of the cost of a sequentially fetched disk page; measured on an arbitrary scale."/>
      <metric property="Runtime.server_encoding" displayName="Server Encoding" dataType="trait"
              description="The server (database) character set encoding."/>
      <metric property="Runtime.server_version" displayName="Server Version" dataType="trait"
              description="Shows the PostgreSQL version."/>
      <metric property="Runtime.server_version_num" displayName="Server Version Num" dataType="trait"
              description="Shows the PostgreSQL version as an integer (e.g. 80204 translates to 8.2.4)."/>
      <metric property="Runtime.shared_buffers" displayName="Shared Buffers" dataType="trait"
              description="The amount of memory for the shared memory buffers used by the server"/>
      <metric property="Runtime.shared_preload_libraries" displayName="Shared Preload Libraries" dataType="trait"
              description="Lists shared libraries to preload into server."/>
      <metric property="Runtime.silent_mode" displayName="Silent Mode" dataType="trait"
              description="Runs the server silently."/>
      <metric property="Runtime.sql_inheritance" displayName="Sql Inheritance" dataType="trait"
              description="Causes subtables to be included by default in various commands."/>
      <metric property="Runtime.ssl" displayName="Ssl" dataType="trait"
              description="Enables SSL connections."/>
      <metric property="Runtime.standard_conforming_strings" displayName="Standard Conforming Strings" dataType="trait"
              description="'...' strings treat backslashes literally."/>
      <metric property="Runtime.statement_timeout" displayName="Statement Timeout" dataType="trait"
              description="The maximum allowed duration of any statement; default unit is milliseconds"/>
      <metric property="Runtime.stats_block_level" displayName="Stats Block Level" dataType="trait"
              description="Collects block-level statistics on database activity."/>
      <metric property="Runtime.stats_command_string" displayName="Stats Command String" dataType="trait"
              description="Collects information about executing commands."/>
      <metric property="Runtime.stats_reset_on_server_start" displayName="Stats Reset On Server Start" dataType="trait"
              description="Zeroes collected statistics on server restart."/>
      <metric property="Runtime.stats_row_level" displayName="Stats Row Level" dataType="trait"
              description="Collects row-level statistics on database activity."/>
      <metric property="Runtime.stats_start_collector" displayName="Stats Start Collector" dataType="trait"
              description="Starts the server statistics-collection subprocess."/>
      <metric property="Runtime.superuser_reserved_connections" displayName="Superuser Reserved Connections" dataType="trait"
              description="The number of connection slots reserved for superusers"/>
      <metric property="Runtime.tcp_keepalives_count" displayName="Tcp Keepalives Count" dataType="trait"
              description="Maximum number of TCP keepalive retransmits; '0' selects the system default"/>
      <metric property="Runtime.tcp_keepalives_idle" displayName="Tcp Keepalives Idle" dataType="trait"
              description="Amount of time between issuing TCP keepalives; '0' selects the system default; default unit is seconds"/>
      <metric property="Runtime.tcp_keepalives_interval" displayName="Tcp Keepalives Interval" dataType="trait"
              description="Amount of time between TCP keepalive retransmits; '0' selects the system default; default unit is seconds"/>
      <metric property="Runtime.temp_buffers" displayName="Temp Buffers" dataType="trait"
              description="The maximum number of temporary buffers used by each session."/>
      <metric property="Runtime.TimeZone" displayName="TimeZone" dataType="trait"
              description="The time zone for displaying and interpreting time stamps."/>
      <metric property="Runtime.timezone_abbreviations" displayName="Timezone Abbreviations" dataType="trait"
              description="Selects a file of time zone abbreviations"/>
      <metric property="Runtime.trace_notify" displayName="Trace Notify" dataType="trait"
              description="Generates debugging output for LISTEN and NOTIFY."/>
      <metric property="Runtime.trace_sort" displayName="Trace Sort" dataType="trait"
              description="Emit information about resource usage in sorting."/>
      <metric property="Runtime.transaction_isolation" displayName="Transaction Isolation" dataType="trait"
              description="The current transaction's isolation level."/>
      <metric property="Runtime.transaction_read_only" displayName="Transaction Read Only" dataType="trait"
              description="The current transaction's read-only status."/>
      <metric property="Runtime.transform_null_equals" displayName="Transform Null Equals" dataType="trait"
              description="Treats expr=NULL as expr IS NULL"/>
      <metric property="Runtime.unix_socket_directory" displayName="Unix Socket Directory" dataType="trait"
              description="The directory where the Unix-domain socket will be created"/>
      <metric property="Runtime.unix_socket_group" displayName="Unix Socket Group" dataType="trait"
              description="The owning group of the Unix-domain socket"/>
      <metric property="Runtime.unix_socket_permissions" displayName="Unix Socket Permissions" dataType="trait"
              description="The access permissions of the Unix-domain socket"/>
      <metric property="Runtime.update_process_title" displayName="Update Process Title" dataType="trait"
              description="Updates the process title to show the active SQL command."/>
      <metric property="Runtime.vacuum_cost_delay" displayName="Vacuum Cost Delay" dataType="trait"
              description="Vacuum cost delay; default unit is milliseconds; range 0-1000"/>
      <metric property="Runtime.vacuum_cost_limit" displayName="Vacuum Cost Limit" dataType="trait"
              description="Vacuum cost (in credits) amount available before napping."/>
      <metric property="Runtime.vacuum_cost_page_dirty" displayName="Vacuum Cost Page Dirty" dataType="trait"
              description="Vacuum cost (in credits) for a page dirtied by vacuum; range 0-10000"/>
      <metric property="Runtime.vacuum_cost_page_hit" displayName="Vacuum Cost Page Hit" dataType="trait"
              description="Vacuum cost (in credits) for a page found in the buffer cache; range 0-10000"/>
      <metric property="Runtime.vacuum_cost_page_miss" displayName="Vacuum Cost Page Miss" dataType="trait"
              description="Vacuum cost (in credits) for a page not found in the buffer cache; range 0-10000"/>
      <metric property="Runtime.vacuum_freeze_min_age" displayName="Vacuum Freeze Min Age" dataType="trait"
              description="Minimum age (in transactions) at which VACUUM should freeze a table row."/>
      <metric property="Runtime.wal_buffers" displayName="Wal Buffers" dataType="trait"
              description="The number of disk-page buffers in shared memory for WAL"/>
      <metric property="Runtime.wal_sync_method" displayName="Wal Sync Method" dataType="trait"
              description="Selects the method used for forcing WAL updates out to disk."/>
      <metric property="Runtime.work_mem" displayName="Work Mem" dataType="trait"
              description="The maximum memory to be used for query workspaces; default unit is kilobytes"/>
      <metric property="Runtime.zero_damaged_pages" displayName="Zero Damaged Pages" dataType="trait"
              description="Continues processing past damaged page headers."/>

     <resource-configuration>
         <!-- NOTE: We do *not* use type="integer" for properties that measure time or data size, because Postgres
                    supports optionally including units in the values of such properties (e.g. 500ms, 30min, 256kB,
                    5MB). -->
         <c:group name="configFile" displayName="Configuration File">
            <c:simple-property name="port" type="integer" description="Sets the TCP port the server listens on; default value is '5432'." activationPolicy="restart" required="false">
               <c:constraint>
                  <c:integer-constraint minimum="1" maximum="65535"/>
               </c:constraint>
            </c:simple-property>
            <c:simple-property name="max_connections" type="integer" description="Sets the maximum number of concurrent connections; default value is '100'." activationPolicy="restart" required="false"/>
            <c:simple-property name="shared_buffers" description="Sets the number of the shared memory buffers used by the server; default value is typically '1000'." activationPolicy="restart" required="false"/>
            <c:simple-property name="max_fsm_pages" type="integer" description="Maximum FSM Pages, must be a minimum of max_fsm_relations*16, 6 bytes each)" activationPolicy="restart" required="false"/>
            <c:simple-property name="log_destination" description="Available options depend on operating system; default value is 'stderr'" required="false">
               <c:property-options>
                  <c:option value="stderr"/>
                  <c:option value="syslog"/>
                  <c:option value="eventlog"/>
               </c:property-options>
            </c:simple-property>
            <c:simple-property name="redirect_stderr" type="boolean" description="Enable capturing of stderr into log files; enabled by default" required="false"/>
            <c:simple-property name="stats_start_collector" type="boolean" description="needed for block or row stats; enabled by default" required="false"/>
            <c:simple-property name="stats_block_level" type="boolean" description="Enables the collection of block-level statistics on database activity; if this option is enabled, the data that is produced can be accessed via the pg_stat and pg_statio family of system views; disabled by default" required="false"/>
            <c:simple-property name="stats_row_level" type="boolean" description="Enables the collection of row-level statistics on database activity; if this option is enabled, the data that is produced can be accessed via the pg_stat and pg_statio family of system views; disabled by default" required="false"/>
            <c:simple-property name="autovacuum" type="boolean" description="Enable autovacuum subprocess? (requires stats_start_collector and stats_row_level to also be on); enabled by default" required="false"/>
         </c:group>
      </resource-configuration>

      <service name="Database" class="PostgresDatabaseComponent" discovery="PostgresDatabaseDiscoveryComponent">
         <plugin-configuration>
            <c:simple-property name="databaseName" displayName="Database Name" readOnly="true" />
         </plugin-configuration>

         <operation name="resetStatistics" displayName="Reset Statistics" description="Resets the statistics in this database"/>
          <operation name="invokeSql" description="Execute arbitrary SQL">
              <parameters>
                  <c:simple-property name="sql"/>
                  <c:simple-property name="type" default="query">
                      <c:property-options>
                          <c:option value="query" name="Query"/>
                          <c:option value="update" name="Update"/>
                      </c:property-options>
                  </c:simple-property>
                  <c:simple-property name="outputFormat" default="html" description="Defaults to HTML.">
                      <c:property-options>
                          <c:option value="html" name="HTML"/>
                          <c:option value="formattedText" name="Formatted Text"/>
                      </c:property-options>
                  </c:simple-property>
              </parameters>
              <results>
                  <c:simple-property name="result"/>
                  <c:simple-property name="contents" type="longString"/>
              </results>
          </operation>

         <metric displayName="Backends" property="numbackends"
                 description="Number of active server processes for database"/>
         <metric displayName="Transactions Committed" property="xact_commit" measurementType="trendsup" displayType="summary"
                 description="Transactions committed in database"/>
         <metric displayName="Transactions Rolled Back" property="xact_rollback" measurementType="trendsup" displayType="summary"
                 description="Transactions rolled back in database"/>
         <metric displayName="Blocks Read" property="blks_read" measurementType="trendsup"
                 description="Number of disk block fetch requests for database"/>
         <metric displayName="Blocks Hit" property="blks_hit" measurementType="trendsup"
                 description="Number of disk block fetch requests found in cache for database "/>
         <metric displayName="Size" property="size" units="bytes" displayType="summary"
                 description="Disk space used by the database"/>

         <service name="Table" class="PostgresTableComponent" discovery="PostgresTableDiscoveryComponent"
                  description="Database table" createDeletePolicy="both" creationDataType="configuration">

            <plugin-configuration>
              <c:simple-property name="schemaName" default="public"/>
              <c:simple-property name="tableName"/>
            </plugin-configuration>

           <operation name="vacuum" description="Vacuum the table"/>

           <metric displayName="Sequential Scans" property="seq_scan" measurementType="trendsup"
                    description="Number of sequential scans done against this table (when an index scan was not possible)"/>
            <metric displayName="Sequential Rows Read" property="seq_tup_read" measurementType="trendsup"
                    description="Number of rows read by sequential scans"/>
            <metric displayName="Index Scans" property="idx_scan" measurementType="trendsup"
                    description="Number of index scans done against this table"/>
            <metric displayName="Index Scan Rows Read" property="idx_tup_fetch" measurementType="trendsup"
                    description="Number of index entries returned by index scans"/>

            <metric displayName="Heap Blocks Read" property="heap_blks_read" measurementType="trendsup"
                    description="The number of heap blocks read that were not a buffer cache hit"/>
            <metric displayName="Heap Blocks Hit" property="heap_blks_hit" measurementType="trendsup"
                    description="The number of heap block requests that were found in the buffer cache"/>
            <metric displayName="Index Blocks Read" property="idx_blks_read" measurementType="trendsup"
                    description="The number of index blocks fetched that were not a buffer cache hit"/>
            <metric displayName="Index Blocks Hit" property="idx_blks_hit" measurementType="trendsup"
                    description="The number of index block requests that were found in the buffer cache"/>
            <metric displayName="Toast Blocks Reads" property="toast_blks_read" measurementType="trendsup"
                    description="The number of toast blocks fetched that were not a buffer cache hit"/>
            <metric displayName="Toast Blocks Hit" property="toast_blks_hit" measurementType="trendsup"
                    description="The number of toast block requests that were found in the buffer cache"/>
            <metric displayName="Toast Index Blocks Read" property="tidx_blks_read" measurementType="trendsup"
                    description="The number of toast index blocks fetched that were not a buffer cache hit"/>
            <metric displayName="Toast Index Blocks Hit" property="tidx_blks_hit" measurementType="trendsup"
                    description="The number of toast index block requests that were found in the buffer cache"/>

            <metric displayName="Row Inserts" property="n_tup_ins" measurementType="trendsup"
                    description="The number of rows ever inserted into this table"/>
            <metric displayName="Row Updates" property="n_tup_upd" measurementType="trendsup"
                    description="The number of rows ever updated on this table"/>
            <metric displayName="Row Deletes" property="n_tup_del" measurementType="trendsup"
                    description="The number of rows ever deleted from this table"/>

            <metric displayName="Table Size" property="table_size" measurementType="dynamic" displayType="summary" units="bytes"
                    description="The size in bytes of the data in the table"/>
            <metric displayName="Total Size" property="total_size" measurementType="dynamic" displayType="summary" units="bytes"
                    description="The size in bytes of the data and all associated indexes and toast tables"/>
            <metric displayName="Rows" property="rows" measurementType="dynamic"
                    defaultOn="false"
                    description="The count of rows in the table. Warning: This may be an expensive operation"/>
            <metric displayName="Approximate rows" property="rows_approx" measurementType="dynamic"
                    defaultOn="false"
                    description="The approximate count of rows in the table. This is basically the number of rows of the last ANALYZE of the table. This metric is not expensive."/>

            <resource-configuration>
              <c:simple-property name="schemaName" readOnly="true"/>
              <c:simple-property name="tableName" readOnly="true"/>
              <c:list-property name="columns">
                  <c:map-property name="columnDefinition">
                     <c:simple-property name="columnName" displayName="Column Name" summary="true" description="name of the column"/>
                     <c:simple-property name="columnType" displayName="Type" summary="true" description="data type of the column, if it is a built-in type, or ARRAY if it is some array (in that case, see the view element_types), else USER-DEFINED (in that case, the type is identified in udt_name and associated columns).">
                        <!-- See: http://www.postgresql.org/docs/8.2/interactive/datatype.html#DATATYPE-TABLE -->
                        <c:property-options>
                           <c:option value="abstime"/>
                           <c:option value="aclitem"/>
                           <c:option value="bigint"/>
                           <c:option value="bigserial"/>
                           <c:option value="bit"/>
                           <c:option value="bit varying"/>
                           <c:option value="bool"/>
                           <c:option value="boolean"/>
                           <c:option value="bytea"/>
                           <c:option value="char"/>
                           <c:option value="character"/>
                           <c:option value="character varying"/>
                           <c:option value="cid"/>
                           <c:option value="cidr"/>
                           <c:option value="circle"/>
                           <c:option value="date"/>
                           <c:option value="decimal"/>
                           <c:option value="double precision"/>
                           <c:option value="float4"/>
                           <c:option value="float8"/>
                           <c:option value="inet"/>
                           <c:option value="int"/>
                           <c:option value="int2"/>
                           <c:option value="int4"/>
                           <c:option value="int8"/>
                           <c:option value="integer"/>
                           <c:option value="interval"/>
                           <c:option value="macaddr"/>
                           <c:option value="money"/>
                           <c:option value="numeric"/>
                           <c:option value="oid"/>
                           <c:option value="path"/>
                           <c:option value="polygon"/>
                           <c:option value="real"/>
                           <c:option value="refcursor"/>
                           <c:option value="regclass"/>
                           <c:option value="regoper"/>
                           <c:option value="regoperator"/>
                           <c:option value="regproc"/>
                           <c:option value="regprocedure"/>
                           <c:option value="regtype"/>
                           <c:option value="reltime"/>
                           <c:option value="serial"/>
                           <c:option value="serial4"/>
                           <c:option value="serial8"/>
                           <c:option value="smallint"/>
                           <c:option value="smgr"/>
                           <c:option value="text"/>
                           <c:option value="tid"/>
                           <c:option value="time"/>
                           <c:option value="timetz"/>
                           <c:option value="time with time zone"/>
                           <c:option value="time without time zone"/>
                           <c:option value="timestamp"/>
                           <c:option value="timestamptz"/>
                           <c:option value="timestamp with time zone"/>
                           <c:option value="timestamp without time zone"/>
                           <c:option value="tinterval"/>
                           <c:option value="varbit"/>
                           <c:option value="varchar"/>
                           <c:option value="xid"/>
                           <c:option value="abstime[]"/>
                           <c:option value="aclitem[]"/>
                           <c:option value="bigint[]"/>
                           <c:option value="bigserial[]"/>
                           <c:option value="bit[]"/>
                           <c:option value="bit varying[]"/>
                           <c:option value="bool[]"/>
                           <c:option value="boolean[]"/>
                           <c:option value="bytea[]"/>
                           <c:option value="char[]"/>
                           <c:option value="character[]"/>
                           <c:option value="character varying[]"/>
                           <c:option value="cid[]"/>
                           <c:option value="cidr[]"/>
                           <c:option value="circle[]"/>
                           <c:option value="date[]"/>
                           <c:option value="decimal[]"/>
                           <c:option value="double precision[]"/>
                           <c:option value="float4[]"/>
                           <c:option value="float8[]"/>
                           <c:option value="inet[]"/>
                           <c:option value="int[]"/>
                           <c:option value="int2[]"/>
                           <c:option value="int4[]"/>
                           <c:option value="int8[]"/>
                           <c:option value="integer[]"/>
                           <c:option value="interval[]"/>
                           <c:option value="macaddr[]"/>
                           <c:option value="money[]"/>
                           <c:option value="numeric[]"/>
                           <c:option value="oid[]"/>
                           <c:option value="path[]"/>
                           <c:option value="polygon[]"/>
                           <c:option value="real[]"/>
                           <c:option value="refcursor[]"/>
                           <c:option value="regclass[]"/>
                           <c:option value="regoper[]"/>
                           <c:option value="regoperator[]"/>
                           <c:option value="regproc[]"/>
                           <c:option value="regprocedure[]"/>
                           <c:option value="regtype[]"/>
                           <c:option value="reltime[]"/>
                           <c:option value="serial[]"/>
                           <c:option value="serial4[]"/>
                           <c:option value="serial8[]"/>
                           <c:option value="smallint[]"/>
                           <c:option value="smgr[]"/>
                           <c:option value="text[]"/>
                           <c:option value="tid[]"/>
                           <c:option value="time[]"/>
                           <c:option value="timetz[]"/>
                           <c:option value="time with time zone[]"/>
                           <c:option value="time without time zone[]"/>
                           <c:option value="timestamp[]"/>
                           <c:option value="timestamptz[]"/>
                           <c:option value="timestamp with time zone[]"/>
                           <c:option value="timestamp without time zone[]"/>
                           <c:option value="tinterval[]"/>
                           <c:option value="varbit[]"/>
                           <c:option value="varchar[]"/>
                           <c:option value="xid[]"/>
                        </c:property-options>
                     </c:simple-property>
                     <c:simple-property name="columnLength" displayName="Length" type="integer" required="false" summary="true" description="if data_type identifies a character or bit string type, the declared maximum length; null for all other data types or if no maximum length was declared"/>
                     <c:simple-property name="columnPrecision" displayName="Precision" type="integer" required="false" summary="true" description="if data_type identifies a numeric type, this column contains the (declared or implicit) precision of the type for this column; the precision indicates the number of significant digits. It can be expressed in decimal (base 10) or binary (base 2) terms, as specified in the column numeric_precision_radix; for all other data types, this column is null"/>
                     <c:simple-property name="columnNullable" displayName="Nullable" type="boolean" required="false" summary="true" description="YES if the column is possibly nullable, NO if it is known not nullable; a not-null constraint is one way a column can be known not nullable, but there can be others"/>
                     <c:simple-property name="columnDefault" displayName="Default" type="string" required="false" description="default expression of the column"/>

                  </c:map-property>
               </c:list-property>
            </resource-configuration>

         </service>


          <service name="Query"
                   class="org.rhq.plugins.database.CustomTableComponent"
                   discovery="org.rhq.plugins.database.CustomTableDiscoveryComponent"
                   supportsManualAdd="true">

              <plugin-configuration>
                  <c:simple-property name="table" description="The table to discover and to be queried on for metric data"/>
                  <c:simple-property name="name" required="false" description="Initial name of the resource when manually added. This is also part of the resource key - make this unique if you want two Query resources based on the same table."/>
                  <c:simple-property name="description" required="false" description="Initial description of resource when manually added"/>
                  <c:simple-property name="metricQuery" required="false" description="The query that will gather metric data. This must return two columns, a string column whose value is 'metricColumn' and then a numeric column whose value is the metric to be collected."/>
              </plugin-configuration>

              <metric property="metricColumn" displayName="Metric Value" displayType="summary" description="The metric value for this Query. If Metric Query is not specified, this is not collected."/>

          </service>

      </service>

      <service name="User" discovery="PostgresUserDiscoveryComponent" class="PostgresUserComponent"
               createDeletePolicy="both" creationDataType="configuration"
               description="A User in the Postgres System">

         <metric property="total" displayName="Total User Connections" displayType="summary"
                 description="The total number of user connections in the system, whether actively querying or idle"/>
         <metric property="active" displayName="Active User Connections" displayType="summary"
                 description="The number of user connections in the system actively querying"/>

         <!-- NOTE: The below is commented, because PostgresUserComponent does not yet implement ConfigurationFacet. -->
         <resource-configuration>
            <c:simple-property name="user"/>
            <c:simple-property name="canLogin" type="boolean" default="true"/>
            <c:simple-property name="password" type="password"/>

            <c:group name="privileges" displayName="Privileges">
               <c:simple-property name="inheritRights" displayName="Inherit Rights" type="boolean" default="true"
                   description="Inherit rights from parent roles."/>
               <c:simple-property name="superuser" displayName="Super User" type="boolean" default="false"
                   description="Is a super user."/>
               <c:simple-property name="canCreateDatabaseObjects" displayName="Can Create Database Types" type="boolean" default="false"
                   description="Implied for a super user."/>
               <c:simple-property name="canCreateRoles" displayName="Can Create Roles" type="boolean" default="false"
                   description="Implied for a super user."/>
               <c:simple-property name="canModifyCatalogDirectly" displayName="Can Update System Catalogs Directly" type="boolean" default="false"
                   description="Even a superuser cannot update system catalogs unless this property is true. False is implied for a non super user."/>
               <c:simple-property name="connectionLimit" displayName="User connection limit" type="integer" default="-1"/>
            </c:group>
         </resource-configuration>

      </service>

   </server>

</plugin>
